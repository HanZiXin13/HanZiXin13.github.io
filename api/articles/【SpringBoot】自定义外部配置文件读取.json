{"title":"ã€SpringBootã€‘è‡ªå®šä¹‰å¤–éƒ¨é…ç½®æ–‡ä»¶è¯»å–","uid":"c4c0028f53dfa8eb1982c4248f9ab94a","slug":"ã€SpringBootã€‘è‡ªå®šä¹‰å¤–éƒ¨é…ç½®æ–‡ä»¶è¯»å–","date":"2022-05-27T07:53:01.000Z","updated":"2022-05-27T09:18:46.205Z","comments":true,"path":"api/articles/ã€SpringBootã€‘è‡ªå®šä¹‰å¤–éƒ¨é…ç½®æ–‡ä»¶è¯»å–.json","keywords":null,"cover":"https://img.zcool.cn/community/0189d45996dc5500000021290a96b8.jpg@1280w_1l_2o_100sh.jpg","content":"<h1 id=\"è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰\"><a href=\"#è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰\" class=\"headerlink\" title=\"è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰\"></a>è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰</h1><p>ä½¿ç”¨çš„æ³¨è§£<code>@ConfigurationPropertiesï¼Œ@ConditionalOnProperty</code><br>åœ¨ä¸€æ¬¡æ—¥å¸¸å†™ä»£ç ä¸­ï¼ŒæŒ‰ç€åº¦å¨˜å†™çš„ä»£ç å»è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå‘ç° <code>@ConditionalOnProperty</code> è¿™ä¸ªæ³¨è§£æ€»æ˜¯éªŒè¯ä¸é€šè¿‡ï¼ˆå¯¼è‡´beanæ³¨å†Œä¸ä¸Šå»ï¼‰ã€‚ä»”ç»†æŸ¥æ‰¾ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°å†™æ³•å¹¶æ— é”™è¯¯ï¼Œä½†å°±æ˜¯éªŒè¯ä¸é€šè¿‡ï¼Œå‘ç°é…ç½®æ–‡ä»¶ä¸­ä¸ä¸º<strong>on</strong>å°±èƒ½é€šè¿‡ï¼Œå³ä½¿æ˜¯<strong>false</strong>ä¹Ÿèƒ½é€šè¿‡ï¼ˆè¿™é‡Œæ˜¯æŒ‡å­—ç¬¦ä¸²ï¼‰ã€‚äºæ˜¯å¼€å§‹ä¸€ä¸‹åˆçš„æ’å‘ä¹‹æ—…ã€‚</p>\n<h4 id=\"å…ˆè¯´ç»“è®º\"><a href=\"#å…ˆè¯´ç»“è®º\" class=\"headerlink\" title=\"å…ˆè¯´ç»“è®º\"></a>å…ˆè¯´ç»“è®º</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>SpringBootä¸­è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¼šå…ˆç»™å­—æ®µæ‰“ä¸Šæ ‡è¯†ç¬¦<strong>Tag</strong>æ¥è¯†åˆ«ä»–æ˜¯æŸä¸€ä¸ªç±»å‹ï¼Œä¾‹å¦‚æœ‰<strong>strã€seqã€mapã€æ—¶é—´æˆ³ç­‰</strong>ã€‚ä¸åŒçš„ç±»å‹ä¼šæœ‰ä¸åŒçš„é»˜è®¤å€¼ï¼Œè€Œvalueä¸ºonæ—¶ï¼Œä¼šè¯†åˆ«æˆ<strong>bool</strong>ç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯trueï¼Œè¿™æ ·å’Œæ³¨è§£<code>@ConditionalOnProperty(havingValue=&quot;on&quot;)</code>ä¸­çš„onè‡ªç„¶ä¸ç›¸ç­‰ï¼Œä¹Ÿå°±ä¼šä¸€ç›´æ ¡éªŒå¤±è´¥ã€‚</p></blockquote>\n<ul>\n<li>é‚£ä¹ˆSpringBootæ˜¯æ ¹æ®ä»€ä¹ˆæ¥ç»™å­—æ®µæ‰“ä¸Šæ ‡ç­¾çš„å‘¢ï¼Ÿ<br>ç»è¿‡ä¸€ä¸‹åˆçš„æŸ¥è¯¢æ‰¾åˆ°åœ¨SpringBootä¸­æœ‰ä¸€ä¸ªå«\t<code>Resolver</code>çš„ç±»ï¼Œä»–çš„ä¸€ä¸ªå­—æ®µ<code>yamlImplicitResolvers</code>é‡Œé¢å°±å­˜æ”¾äº†å­—æ®µçš„æ ¡éªŒè§„åˆ™ã€‚</li>\n</ul>\n<p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹æ ¡éªŒçš„æºç :</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">public Tag resolve(NodeId kind, String value, boolean implicit) &#123;\n    if (kind &#x3D;&#x3D; NodeId.scalar &amp;&amp; implicit) &#123;\n        final List&lt;ResolverTuple&gt; resolvers;\n        &#x2F;*\n        è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒyamlImplicitResolversä¼šå»å–å­—æ®µçš„ç¬¬ä¸€ä¸ªå­—æ¯åšæ ¡éªŒ\n        *&#x2F;\n        if (value.length() &#x3D;&#x3D; 0) &#123;\n            resolvers &#x3D; yamlImplicitResolvers.get(&#39;\\0&#39;);\n        &#125; else &#123;\n            resolvers &#x3D; yamlImplicitResolvers.get(value.charAt(0));\n        &#125;\n        &#x2F;&#x2F; yamlImplicitResolversä¸­åˆ†nullå’Œénullï¼Œè¿™é‡Œæ˜¯énullçš„æƒ…å†µ\n        if (resolvers !&#x3D; null) &#123;\n            for (ResolverTuple v : resolvers) &#123;\n                Tag tag &#x3D; v.getTag();\n                Pattern regexp &#x3D; v.getRegexp();\n                &#x2F;&#x2F; è¿™é‡Œä¼šè¿›è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œåªæœ‰åŒ¹é…ä¸Šäº†æ‰èƒ½è¿”å›\n                if (regexp.matcher(value).matches()) &#123;\n                    return tag;\n                &#125;\n            &#125;\n        &#125;\n        if (yamlImplicitResolvers.containsKey(null)) &#123;\n            for (ResolverTuple v : yamlImplicitResolvers.get(null)) &#123;\n                Tag tag &#x3D; v.getTag();\n                Pattern regexp &#x3D; v.getRegexp();\n                &#x2F;&#x2F; åŒä¸Š\n                if (regexp.matcher(value).matches()) &#123;\n                    return tag;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; å¦‚æœåœ¨yamlImplicitResolversæ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœï¼Œé‚£ä¹ˆå°±è¿”å›ä¼ è¿›æ¥çš„kindï¼ˆä¸€èˆ¬æ˜¯strï¼‰\n    switch (kind) &#123;\n    case scalar:\n        return Tag.STR;\n    case sequence:\n        return Tag.SEQ;\n    default:\n        return Tag.MAP;\n    &#125;\n&#125;</code></pre>\n<p>æ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¸éš¾å¾—å‡º <strong>yamlImplicitResolverså°±æ˜¯ä¸€ä¸ªMapï¼Œé‡Œé¢çš„keyä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œç”¨äºåŒ¹é…å­—æ®µåï¼Œvalueä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæœ‰åŒæ—¶åŒ¹é…keyå’Œvalueæ‰è¿”å›å®Œæ•´çš„Tag</strong>ã€‚</p>\n<ul>\n<li>æ³¨æ„è¿™é‡Œkeyå’ŒvalueæŒ‡çš„æ˜¯yamlImplicitResolverså¯¹è±¡çš„keyå’Œvalueï¼Œè€Œä¸æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„keyå’Œvalueã€‚</li>\n</ul>\n<p>åˆ—ä¸¾ä¸€äº›yamlImplicitResolversä¸­çš„å€¼ï¼š</p>\n<ul>\n<li><code>null-&gt;[^(?:~|null|Null|NULL| )$,^$]</code></li>\n<li><code>F-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$]</code></li>\n<li><code>N-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$, ^(?:~|null|Null|NULL| )$]</code></li>\n<li>(<em>ä¸‡æ¶ä¹‹æº</em>)<code>o-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$]</code><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>æ³¨æ„ï¼Œé…ç½®æ–‡ä»¶ä¸­åªæœ‰valueéœ€è¦æ³¨æ„å†™æ³•ï¼Œå¦‚æœåœ¨<code>@ConfigurationProperties</code>æ ‡è¯†çš„ç±»ä¸­å®šä¹‰äº†å­—æ®µç±»å‹ï¼Œé‚£ä¹ˆå°±ä¸ä¼šè‡ªè¡Œè½¬æ¢äº†ï¼ˆå¯èƒ½ï¼‰ã€‚</p></blockquote>\n</li>\n</ul>\n<h4 id=\"ç—›è‹¦è®°å¿†\"><a href=\"#ç—›è‹¦è®°å¿†\" class=\"headerlink\" title=\"ç—›è‹¦è®°å¿†\"></a>ç—›è‹¦è®°å¿†</h4><ol>\n<li>æœ€å¼€å§‹ä»¥ä¸ºæ˜¯å†™æ³•é—®é¢˜ï¼Œå±æ€§å€¼å†™é”™äº†ä¹‹ç±»çš„ã€‚ç‚¹è¿›å»<code>@ConditionalOnProperty</code>é‡Œçœ‹äº†å¾ˆå¤šéï¼Œå¾ˆå¤šæ–¹æ³•éƒ½è¯•è¿‡äº†ï¼Œå‘ç°æ²¡æœ‰é—®é¢˜ã€‚ç„¶åè¯•äº†ä¸‹å®˜æ–¹æ–‡æ¡£çš„å®ä¾‹ï¼Œå‘ç°éƒ½å¯ä»¥ï¼Œç”šè‡³falseéƒ½å¯ä»¥ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µåº”è¯¥æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œç„¶åå‘ç°åªæœ‰ç”¨<strong>on</strong>ä¸è¡Œï¼Œäºæ˜¯çŒœæƒ³æ˜¯ä¸æ˜¯SpringBootè‡ªå¸¦ä»€ä¹ˆå¥‡æ€ªçš„è½¬åŒ–é—®é¢˜ã€‚</li>\n<li><del>å…¶å®åœ¨ä¸€å¼€å§‹æ˜¯æŠ¥çš„æ‰¾ä¸åˆ°beanè¿™ä¸ªé”™ï¼Œä¸€é¡¿æ’æŸ¥æ‰¾åˆ°äº†å¸¦<code>@ConditionalOnProperty</code>çš„è¿™ä¸ªæ–¹æ³•ï¼ŒçŒœæƒ³æ‰“äº†æ–­ç‚¹å‘ç°æ ¹æœ¬æ²¡åˆ›å»ºbeanï¼ŒçŒœæƒ³æ˜¯ä¸æ˜¯æ²¡é€šè¿‡æ ¡éªŒã€‚ğŸ˜‚</del></li>\n<li>ç„¶åå‡†å¤‡å»æ‰¾ï¼Œæ˜¯ä¸æ˜¯<code>@ConditionalOnProperty</code>é‡Œé¢åšäº†ä»€ä¹ˆå¥‡æ€ªçš„æ“ä½œæŠŠå±æ€§<strong>havingValue</strong>çš„å€¼ç»™æ”¹æ‰äº†ï¼Œä½†è‡ªå·±å¯¹Springä¸ç®—å¾ˆç†Ÿç»ƒï¼ŒåªçŸ¥é“SpringAopä¼šå¯¹æ–¹æ³•ä»£ç†ï¼Œæ‰§è¡Œä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œ<em>è¿™ä¹ˆå¿«æƒ³åˆ°æ˜¯å› ä¸ºä¹‹å‰è‡ªå·±å†™è¿‡AOPæ—¥å¿—</em>ã€‚äºæ˜¯æƒ³ç€å»æ‰¾Springçš„æ–¹æ³•å¢å¼ºé‡Œé¢æ‰¾ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŠŠæ–¹æ³•æ³¨è§£ç»™æˆ‘æ”¹ä¸œè¥¿äº†ã€‚</li>\n<li>é¦–å…ˆæ‰¾åˆ°æ‰“å°æ—¥å¿—çš„ç±»<code>NoSuchBeanDefinitionFailureAnalyzer</code> é€šè¿‡debug è§‚å¯Ÿåˆ°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä½†æ˜¯è¿™ä¸ªå¼‚å¸¸ä»…ä»…æ˜¯æ‰¾ä¸åˆ° bean æ‰€æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯¹æˆ‘ä»¬è¦æ‰¾çš„é—®é¢˜æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ã€‚åœ¨æœç´¢<code>ConditionalOnProperty</code>è§‚å¯Ÿåï¼Œåœ¨Springçš„ä¸Šä¸‹æ–‡çš„<code>ConditionContext</code>ä¸­æ‰¾åˆ°äº†åˆ›å»º bean çš„æ–¹æ³•ï¼Œè§‚å¯Ÿå‘ç°åœ¨è¯¥contextä¸­æ³¨è§£çš„å€¼æ˜¯æ­£å¸¸çš„ä¸º**â€onâ€**ã€‚ï¼ˆåœ¨<code>OnPropertyCondition</code>çš„æ ¡éªŒç±»ä¸­çš„<code>getMatchOutcome</code>æ–¹æ³•é‡Œé¢å¯ä»¥æ‰¾åˆ°ï¼Œå¹¶ä¸”debugå‘ç°æŠŠåŒ¹é…ç»“æœåŠ å…¥äº†<code>noMatch</code>é›†åˆä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸ºåŒ¹é…ï¼Œè¯´æ˜é…ç½®æ–‡ä»¶è¯»å–çš„æœ‰é—®é¢˜ã€‚ï¼‰</li>\n<li>ç»§ç»­è§‚å¯Ÿä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå‘ç°äº†é…ç½®æ–‡ä»¶ä¸­çš„å€¼ä¸º<strong>true</strong>ï¼Œè¿™å°±å¾ˆç¥å¥‡äº†ï¼Œæ˜æ˜é…ç½®æ–‡ä»¶ä¸­å†™çš„æ˜¯<strong>on</strong>ï¼Œä¸ºä»€ä¹ˆä¼šå˜æˆ<strong>true</strong>å‘¢ï¼Ÿï¼ˆè¿™é‡Œçš„valueç‚¹è¿›å»æ˜¯<strong>Boolean</strong>ç±»å‹ï¼‰<br><img src=\"https://img-blog.csdnimg.cn/ba86590e717742d589a267d2ad2460bc.png\" alt=\"è‡ªå·±å®šä¹‰çš„å­—æ®µå’Œå€¼\"></li>\n</ol>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><em>åœ¨contextå¯¹è±¡ä¸­æœ‰ä¸€ä¸ª<strong>environment</strong>å¯¹è±¡ï¼Œé‡Œé¢çš„propertySourceså±æ€§é‡Œè®°å½•äº†å¤–éƒ¨æ•°æ®çš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­çš„<code>OriginTrackedMapPropertySource &#123;name=&#39;Config resource &#39;class path resource [application.yaml]&#39; via location &#39;optional:classpath:/&#39;&#39;&#125;</code>å¯¹è±¡å°±æ˜¯è¯»å–æˆ‘ä»¬è‡ªå·±å†™çš„é…ç½®æ–‡ä»¶çš„å¯¹è±¡ï¼Œå†å»é‡Œé¢æ‰¾åˆ°<strong>source</strong>å±æ€§å°±å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ‰€æœ‰å­—æ®µåŒ…æ‹¬å€¼</em></p></blockquote>\n<h4 id=\"æ ¹æœ¬åŸå› \"><a href=\"#æ ¹æœ¬åŸå› \" class=\"headerlink\" title=\"æ ¹æœ¬åŸå› \"></a>æ ¹æœ¬åŸå› </h4><p>åˆ°è¿™é‡Œï¼Œé—®é¢˜ä¼¼ä¹ä¸€ç›®äº†ç„¶äº†ï¼Œ<strong>æ˜¾ç„¶æ˜¯SpringBootåœ¨è¯»å–é…ç½®æ–‡ä»¶æ—¶ï¼Œæ ¹æ®å­—æ®µæˆ–è€…å€¼åœ¨è½¬æˆjavaå¯¹åº”çš„ç±»å‹æ—¶è½¬å‡ºäº†é—®é¢˜ã€‚</strong><br>é‚£ä¹ˆSpringBootæ˜¯æ€ä¹ˆè¯»å–é…ç½®æ–‡ä»¶çš„å‘¢ï¼Œåº¦å¨˜äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†è¿™ä¸ªç±»<code>YamlPropertySourceLoader</code>æ˜¯ç”¨äºè¯»å–yamlæ–‡ä»¶çš„ï¼Œï¼ˆé¡ºå¸¦æä¸€å¥ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°ymlå’Œyamlæ˜¯ä¸€ä¸ªæ–‡ä»¶ç±»å‹ï¼‰ã€‚éšååœ¨æ ¸å¿ƒæ–¹æ³•é‡Œå¯ä»¥æ‰¾åˆ°è°ƒç”¨çš„<code>OriginTrackedYamlLoader</code>è¿™è´§çš„loadæ–¹æ³•</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">public List&lt;PropertySource&lt;?&gt;&gt; load(String name, Resource resource) throws IOException &#123;\n\tif (!ClassUtils.isPresent(&quot;org.yaml.snakeyaml.Yaml&quot;, getClass().getClassLoader())) &#123;\n\t\tthrow new IllegalStateException(\n\t\t\t\t&quot;Attempted to load &quot; + name + &quot; but snakeyaml was not found on the classpath&quot;);\n\t&#125;\n\t&#x2F;&#x2F; å°±åœ¨è¿™é‡Œ\n\tList&lt;Map&lt;String, Object&gt;&gt; loaded &#x3D; new OriginTrackedYamlLoader(resource).load();\n\tif (loaded.isEmpty()) &#123;\n\t\treturn Collections.emptyList();\n\t&#125;\n\tList&lt;PropertySource&lt;?&gt;&gt; propertySources &#x3D; new ArrayList&lt;&gt;(loaded.size());\n\tfor (int i &#x3D; 0; i &lt; loaded.size(); i++) &#123;\n\t\tString documentNumber &#x3D; (loaded.size() !&#x3D; 1) ? &quot; (document #&quot; + i + &quot;)&quot; : &quot;&quot;;\n\t\tpropertySources.add(new OriginTrackedMapPropertySource(name + documentNumber,\n\t\t\t\tCollections.unmodifiableMap(loaded.get(i)), true));\n\t&#125;\n\treturn propertySources;\n&#125;</code></pre>\n<p>åœ¨loadé‡Œé¢ç»§ç»­è°ƒç”¨äº†<code>YamlProcessor</code>ç±»çš„<code>process</code>æ–¹æ³•</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">private boolean process(MatchCallback callback, Yaml yaml, Resource resource) &#123;\n\tint count &#x3D; 0;\n\ttry &#123;\n\t\tif (logger.isDebugEnabled()) &#123;\n\t\t\tlogger.debug(&quot;Loading from YAML: &quot; + resource);\n\t\t&#125;\n\t\ttry (Reader reader &#x3D; new UnicodeReader(resource.getInputStream())) &#123;\n\t\t\t&#x2F;&#x2F; åœ¨è¿™é‡Œæ‰ä¼šåŠ è½½yaml\n\t\t\tfor (Object object : yaml.loadAll(reader)) &#123;\n\t\t\t\tif (object !&#x3D; null &amp;&amp; process(asMap(object), callback)) &#123;\n\t\t\t\t\tcount++;\n\t\t\t\t\tif (this.resolutionMethod &#x3D;&#x3D; ResolutionMethod.FIRST_FOUND) &#123;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t\tif (logger.isDebugEnabled()) &#123;\n\t\t\t\tlogger.debug(&quot;Loaded &quot; + count + &quot; document&quot; + (count &gt; 1 ? &quot;s&quot; : &quot;&quot;) +\n\t\t\t\t\t\t&quot; from YAML resource: &quot; + resource);\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n\tcatch (IOException ex) &#123;\n\t\thandleProcessError(resource, ex);\n\t&#125;\n\treturn (count &gt; 0);\n&#125;</code></pre>\n<p>ç‚¹è¿›åŠ è½½æ–¹æ³•<code>loadAll</code>çœ‹ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¿˜å‘ç°é…ç½®æ–‡ä»¶ç”¨æ–‡ä»¶æµè¯»å–ï¼‰ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª<br>å…¨å±€å¯¹è±¡<code>constructor</code>ï¼Œæš‚æ—¶ä¸å»å…³å¿ƒæ€ä¹ˆæ¥çš„ï¼Œå»é‡å†™çš„è¿­ä»£å™¨é‡Œé¢çš„nextæ–¹æ³•å‘ç°è°ƒç”¨çš„æ˜¯<code>constructor</code>å¯¹è±¡çš„<code>getData()</code>æ–¹æ³•ã€‚åœ¨ç‚¹è¿›å»å°±æ˜¯æœ¬æ–‡å¼€å¤´çš„å†…å®¹äº†ï¼Œè¿™é‡Œå°±ä¸å†å¤è¿°äº†ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬æ˜ç™½äº†SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„æœºåˆ¶ï¼Œå¹¶ä¸”äº†è§£äº†é…ç½®æ–‡ä»¶æœ‰ä¸€äº›ç‰¹æ®Šçš„è¯­ä¹‰éœ€è¦æ³¨æ„ã€‚è¿™æ¬¡è§‚å¯ŸSpringBootæºç å‘Šä¸€æ®µè½ï¼Œå…¶å®åœ¨ä¸€å¼€å§‹å°±å¤§æ¦‚çŒœåˆ°äº†æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¸…æ¥šä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œé˜…è¯»å®Œæºç æƒ³æ˜ç™½äº†å¾ˆå¤šï¼Œæ„Ÿè§‰åˆæœ‰æˆé•¿äº†ã€‚</p>\n","feature":true,"text":"è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰ä½¿ç”¨çš„æ³¨è§£@ConfigurationPropertiesï¼Œ@ConditionalOnPropertyåœ¨ä¸€æ¬¡æ—¥å¸¸å†™ä»£ç ä¸­ï¼ŒæŒ‰ç€åº¦å¨˜å†™çš„ä»£ç å»è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå‘ç° @ConditionalOnProperty è¿™ä¸ªæ³¨è§£æ€»...","link":"","photos":[],"count_time":{"symbolsCount":"6.4k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"SpringBoot","slug":"SpringBoot","count":1,"path":"api/tags/SpringBoot.json"},{"name":"Java","slug":"Java","count":1,"path":"api/tags/Java.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%AE%B0SpringBoot%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%9D%91%EF%BC%88%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%89\"><span class=\"toc-text\">è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%85%88%E8%AF%B4%E7%BB%93%E8%AE%BA\"><span class=\"toc-text\">å…ˆè¯´ç»“è®º</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%97%9B%E8%8B%A6%E8%AE%B0%E5%BF%86\"><span class=\"toc-text\">ç—›è‹¦è®°å¿†</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%A0%B9%E6%9C%AC%E5%8E%9F%E5%9B%A0\"><span class=\"toc-text\">æ ¹æœ¬åŸå› </span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">æ€»ç»“</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Xin_Chen","slug":"xin_chen","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"å‰æ–¹å‡€ç©ºï¼Œæµ®æ ‡å·²äº®ï¼Œå‡†è®¸è·ƒè¿<br/>æ„¿è¯¸å›æ­¦è¿æ˜Œç››ï¼Œç‡ƒå°½æ˜Ÿç©º","socials":{"github":"https://github.com/hanzixin13","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ã€å†…ç½‘ç©¿é€ã€‘FRPæ­å»ºå†…å¤–ç©¿é€","uid":"debc4d6563791bdbea268a12e8990d21","slug":"ã€å†…ç½‘ç©¿é€ã€‘ä»é›¶å¼€å§‹æ­å»ºFRPæœåŠ¡","date":"2022-07-07T12:35:01.000Z","updated":"2022-07-07T12:36:15.668Z","comments":true,"path":"api/articles/ã€å†…ç½‘ç©¿é€ã€‘ä»é›¶å¼€å§‹æ­å»ºFRPæœåŠ¡.json","keywords":null,"cover":[],"text":"FRPæ­å»ºå†…å¤–ç©¿é€1. FRPç®€å•ä»‹ç» frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet. As of now, it su...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Linux","slug":"Linux","count":1,"path":"api/tags/Linux.json"},{"name":"FRP","slug":"FRP","count":1,"path":"api/tags/FRP.json"}],"author":{"name":"Xin_Chen","slug":"xin_chen","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"å‰æ–¹å‡€ç©ºï¼Œæµ®æ ‡å·²äº®ï¼Œå‡†è®¸è·ƒè¿<br/>æ„¿è¯¸å›æ­¦è¿æ˜Œç››ï¼Œç‡ƒå°½æ˜Ÿç©º","socials":{"github":"https://github.com/hanzixin13","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"ã€Linuxã€‘Linuxå‘½ä»¤ç¬”è®°","uid":"426935cfda214078fe347e2ba79a50b5","slug":"Linuxå‘½ä»¤ç¬”è®°","date":"2022-05-27T07:27:22.000Z","updated":"2022-05-27T09:49:40.547Z","comments":true,"path":"api/articles/Linuxå‘½ä»¤ç¬”è®°.json","keywords":null,"cover":null,"text":"Linuxå¸¸ç”¨å‘½ä»¤å¼€å¯æŒ‡å®šç«¯å£firewall-cmd --zone&#x3D;public --add-port&#x3D;8080&#x2F;tcp --permanent å«ä¹‰ï¼š â€“zone #ä½œç”¨åŸŸ â€“add-port&#x3D;8080&#x2F;tcp #ç«¯å£&#x2...","link":"","photos":[],"count_time":{"symbolsCount":"5k","symbolsTime":"5 mins."},"categories":[],"tags":[{"name":"linux","slug":"linux","count":1,"path":"api/tags/linux.json"}],"author":{"name":"Xin_Chen","slug":"xin_chen","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"å‰æ–¹å‡€ç©ºï¼Œæµ®æ ‡å·²äº®ï¼Œå‡†è®¸è·ƒè¿<br/>æ„¿è¯¸å›æ­¦è¿æ˜Œç››ï¼Œç‡ƒå°½æ˜Ÿç©º","socials":{"github":"https://github.com/hanzixin13","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}