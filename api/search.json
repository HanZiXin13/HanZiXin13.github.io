[{"id":"c4c0028f53dfa8eb1982c4248f9ab94a","title":"ã€SpringBootã€‘è‡ªå®šä¹‰å¤–éƒ¨é…ç½®æ–‡ä»¶è¯»å–","content":"è®°SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„å‘ï¼ˆè‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰ä½¿ç”¨çš„æ³¨è§£@ConfigurationPropertiesï¼Œ@ConditionalOnPropertyåœ¨ä¸€æ¬¡æ—¥å¸¸å†™ä»£ç ä¸­ï¼ŒæŒ‰ç€åº¦å¨˜å†™çš„ä»£ç å»è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå‘ç° @ConditionalOnProperty è¿™ä¸ªæ³¨è§£æ€»æ˜¯éªŒè¯ä¸é€šè¿‡ï¼ˆå¯¼è‡´beanæ³¨å†Œä¸ä¸Šå»ï¼‰ã€‚ä»”ç»†æŸ¥æ‰¾ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°å†™æ³•å¹¶æ— é”™è¯¯ï¼Œä½†å°±æ˜¯éªŒè¯ä¸é€šè¿‡ï¼Œå‘ç°é…ç½®æ–‡ä»¶ä¸­ä¸ä¸ºonå°±èƒ½é€šè¿‡ï¼Œå³ä½¿æ˜¯falseä¹Ÿèƒ½é€šè¿‡ï¼ˆè¿™é‡Œæ˜¯æŒ‡å­—ç¬¦ä¸²ï¼‰ã€‚äºæ˜¯å¼€å§‹ä¸€ä¸‹åˆçš„æ’å‘ä¹‹æ—…ã€‚\nå…ˆè¯´ç»“è®º\n\n\n\n\n\n\n\n\nSpringBootä¸­è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¼šå…ˆç»™å­—æ®µæ‰“ä¸Šæ ‡è¯†ç¬¦Tagæ¥è¯†åˆ«ä»–æ˜¯æŸä¸€ä¸ªç±»å‹ï¼Œä¾‹å¦‚æœ‰strã€seqã€mapã€æ—¶é—´æˆ³ç­‰ã€‚ä¸åŒçš„ç±»å‹ä¼šæœ‰ä¸åŒçš„é»˜è®¤å€¼ï¼Œè€Œvalueä¸ºonæ—¶ï¼Œä¼šè¯†åˆ«æˆboolç±»å‹ï¼Œé»˜è®¤å€¼æ˜¯trueï¼Œè¿™æ ·å’Œæ³¨è§£@ConditionalOnProperty(havingValue=&quot;on&quot;)ä¸­çš„onè‡ªç„¶ä¸ç›¸ç­‰ï¼Œä¹Ÿå°±ä¼šä¸€ç›´æ ¡éªŒå¤±è´¥ã€‚\n\né‚£ä¹ˆSpringBootæ˜¯æ ¹æ®ä»€ä¹ˆæ¥ç»™å­—æ®µæ‰“ä¸Šæ ‡ç­¾çš„å‘¢ï¼Ÿç»è¿‡ä¸€ä¸‹åˆçš„æŸ¥è¯¢æ‰¾åˆ°åœ¨SpringBootä¸­æœ‰ä¸€ä¸ªå«\tResolverçš„ç±»ï¼Œä»–çš„ä¸€ä¸ªå­—æ®µyamlImplicitResolversé‡Œé¢å°±å­˜æ”¾äº†å­—æ®µçš„æ ¡éªŒè§„åˆ™ã€‚\n\né¦–å…ˆå…ˆçœ‹ä¸€ä¸‹æ ¡éªŒçš„æºç :\npublic Tag resolve(NodeId kind, String value, boolean implicit) &#123;\n    if (kind &#x3D;&#x3D; NodeId.scalar &amp;&amp; implicit) &#123;\n        final List&lt;ResolverTuple&gt; resolvers;\n        &#x2F;*\n        è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒyamlImplicitResolversä¼šå»å–å­—æ®µçš„ç¬¬ä¸€ä¸ªå­—æ¯åšæ ¡éªŒ\n        *&#x2F;\n        if (value.length() &#x3D;&#x3D; 0) &#123;\n            resolvers &#x3D; yamlImplicitResolvers.get(&#39;\\0&#39;);\n        &#125; else &#123;\n            resolvers &#x3D; yamlImplicitResolvers.get(value.charAt(0));\n        &#125;\n        &#x2F;&#x2F; yamlImplicitResolversä¸­åˆ†nullå’Œénullï¼Œè¿™é‡Œæ˜¯énullçš„æƒ…å†µ\n        if (resolvers !&#x3D; null) &#123;\n            for (ResolverTuple v : resolvers) &#123;\n                Tag tag &#x3D; v.getTag();\n                Pattern regexp &#x3D; v.getRegexp();\n                &#x2F;&#x2F; è¿™é‡Œä¼šè¿›è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œåªæœ‰åŒ¹é…ä¸Šäº†æ‰èƒ½è¿”å›\n                if (regexp.matcher(value).matches()) &#123;\n                    return tag;\n                &#125;\n            &#125;\n        &#125;\n        if (yamlImplicitResolvers.containsKey(null)) &#123;\n            for (ResolverTuple v : yamlImplicitResolvers.get(null)) &#123;\n                Tag tag &#x3D; v.getTag();\n                Pattern regexp &#x3D; v.getRegexp();\n                &#x2F;&#x2F; åŒä¸Š\n                if (regexp.matcher(value).matches()) &#123;\n                    return tag;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; å¦‚æœåœ¨yamlImplicitResolversæ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœï¼Œé‚£ä¹ˆå°±è¿”å›ä¼ è¿›æ¥çš„kindï¼ˆä¸€èˆ¬æ˜¯strï¼‰\n    switch (kind) &#123;\n    case scalar:\n        return Tag.STR;\n    case sequence:\n        return Tag.SEQ;\n    default:\n        return Tag.MAP;\n    &#125;\n&#125;\næ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¸éš¾å¾—å‡º yamlImplicitResolverså°±æ˜¯ä¸€ä¸ªMapï¼Œé‡Œé¢çš„keyä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œç”¨äºåŒ¹é…å­—æ®µåï¼Œvalueä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæœ‰åŒæ—¶åŒ¹é…keyå’Œvalueæ‰è¿”å›å®Œæ•´çš„Tagã€‚\n\næ³¨æ„è¿™é‡Œkeyå’ŒvalueæŒ‡çš„æ˜¯yamlImplicitResolverså¯¹è±¡çš„keyå’Œvalueï¼Œè€Œä¸æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„keyå’Œvalueã€‚\n\nåˆ—ä¸¾ä¸€äº›yamlImplicitResolversä¸­çš„å€¼ï¼š\n\nnull-&gt;[^(?:~|null|Null|NULL| )$,^$]\nF-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$]\nN-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$, ^(?:~|null|Null|NULL| )$]\n(ä¸‡æ¶ä¹‹æº)o-&gt;[^(?:yes|Yes|YES|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF)$]\n\n\n\n\n\n\n\n\næ³¨æ„ï¼Œé…ç½®æ–‡ä»¶ä¸­åªæœ‰valueéœ€è¦æ³¨æ„å†™æ³•ï¼Œå¦‚æœåœ¨@ConfigurationPropertiesæ ‡è¯†çš„ç±»ä¸­å®šä¹‰äº†å­—æ®µç±»å‹ï¼Œé‚£ä¹ˆå°±ä¸ä¼šè‡ªè¡Œè½¬æ¢äº†ï¼ˆå¯èƒ½ï¼‰ã€‚\n\n\nç—›è‹¦è®°å¿†\næœ€å¼€å§‹ä»¥ä¸ºæ˜¯å†™æ³•é—®é¢˜ï¼Œå±æ€§å€¼å†™é”™äº†ä¹‹ç±»çš„ã€‚ç‚¹è¿›å»@ConditionalOnPropertyé‡Œçœ‹äº†å¾ˆå¤šéï¼Œå¾ˆå¤šæ–¹æ³•éƒ½è¯•è¿‡äº†ï¼Œå‘ç°æ²¡æœ‰é—®é¢˜ã€‚ç„¶åè¯•äº†ä¸‹å®˜æ–¹æ–‡æ¡£çš„å®ä¾‹ï¼Œå‘ç°éƒ½å¯ä»¥ï¼Œç”šè‡³falseéƒ½å¯ä»¥ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µåº”è¯¥æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œç„¶åå‘ç°åªæœ‰ç”¨onä¸è¡Œï¼Œäºæ˜¯çŒœæƒ³æ˜¯ä¸æ˜¯SpringBootè‡ªå¸¦ä»€ä¹ˆå¥‡æ€ªçš„è½¬åŒ–é—®é¢˜ã€‚\nå…¶å®åœ¨ä¸€å¼€å§‹æ˜¯æŠ¥çš„æ‰¾ä¸åˆ°beanè¿™ä¸ªé”™ï¼Œä¸€é¡¿æ’æŸ¥æ‰¾åˆ°äº†å¸¦@ConditionalOnPropertyçš„è¿™ä¸ªæ–¹æ³•ï¼ŒçŒœæƒ³æ‰“äº†æ–­ç‚¹å‘ç°æ ¹æœ¬æ²¡åˆ›å»ºbeanï¼ŒçŒœæƒ³æ˜¯ä¸æ˜¯æ²¡é€šè¿‡æ ¡éªŒã€‚ğŸ˜‚\nç„¶åå‡†å¤‡å»æ‰¾ï¼Œæ˜¯ä¸æ˜¯@ConditionalOnPropertyé‡Œé¢åšäº†ä»€ä¹ˆå¥‡æ€ªçš„æ“ä½œæŠŠå±æ€§havingValueçš„å€¼ç»™æ”¹æ‰äº†ï¼Œä½†è‡ªå·±å¯¹Springä¸ç®—å¾ˆç†Ÿç»ƒï¼ŒåªçŸ¥é“SpringAopä¼šå¯¹æ–¹æ³•ä»£ç†ï¼Œæ‰§è¡Œä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œè¿™ä¹ˆå¿«æƒ³åˆ°æ˜¯å› ä¸ºä¹‹å‰è‡ªå·±å†™è¿‡AOPæ—¥å¿—ã€‚äºæ˜¯æƒ³ç€å»æ‰¾Springçš„æ–¹æ³•å¢å¼ºé‡Œé¢æ‰¾ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŠŠæ–¹æ³•æ³¨è§£ç»™æˆ‘æ”¹ä¸œè¥¿äº†ã€‚\né¦–å…ˆæ‰¾åˆ°æ‰“å°æ—¥å¿—çš„ç±»NoSuchBeanDefinitionFailureAnalyzer é€šè¿‡debug è§‚å¯Ÿåˆ°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä½†æ˜¯è¿™ä¸ªå¼‚å¸¸ä»…ä»…æ˜¯æ‰¾ä¸åˆ° bean æ‰€æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯¹æˆ‘ä»¬è¦æ‰¾çš„é—®é¢˜æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ã€‚åœ¨æœç´¢ConditionalOnPropertyè§‚å¯Ÿåï¼Œåœ¨Springçš„ä¸Šä¸‹æ–‡çš„ConditionContextä¸­æ‰¾åˆ°äº†åˆ›å»º bean çš„æ–¹æ³•ï¼Œè§‚å¯Ÿå‘ç°åœ¨è¯¥contextä¸­æ³¨è§£çš„å€¼æ˜¯æ­£å¸¸çš„ä¸º**â€onâ€**ã€‚ï¼ˆåœ¨OnPropertyConditionçš„æ ¡éªŒç±»ä¸­çš„getMatchOutcomeæ–¹æ³•é‡Œé¢å¯ä»¥æ‰¾åˆ°ï¼Œå¹¶ä¸”debugå‘ç°æŠŠåŒ¹é…ç»“æœåŠ å…¥äº†noMatché›†åˆä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸ºåŒ¹é…ï¼Œè¯´æ˜é…ç½®æ–‡ä»¶è¯»å–çš„æœ‰é—®é¢˜ã€‚ï¼‰\nç»§ç»­è§‚å¯Ÿä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå‘ç°äº†é…ç½®æ–‡ä»¶ä¸­çš„å€¼ä¸ºtrueï¼Œè¿™å°±å¾ˆç¥å¥‡äº†ï¼Œæ˜æ˜é…ç½®æ–‡ä»¶ä¸­å†™çš„æ˜¯onï¼Œä¸ºä»€ä¹ˆä¼šå˜æˆtrueå‘¢ï¼Ÿï¼ˆè¿™é‡Œçš„valueç‚¹è¿›å»æ˜¯Booleanç±»å‹ï¼‰\n\n\n\n\n\n\n\n\n\n\nåœ¨contextå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªenvironmentå¯¹è±¡ï¼Œé‡Œé¢çš„propertySourceså±æ€§é‡Œè®°å½•äº†å¤–éƒ¨æ•°æ®çš„è¯¦ç»†ä¿¡æ¯ï¼Œå…¶ä¸­çš„OriginTrackedMapPropertySource &#123;name=&#39;Config resource &#39;class path resource [application.yaml]&#39; via location &#39;optional:classpath:/&#39;&#39;&#125;å¯¹è±¡å°±æ˜¯è¯»å–æˆ‘ä»¬è‡ªå·±å†™çš„é…ç½®æ–‡ä»¶çš„å¯¹è±¡ï¼Œå†å»é‡Œé¢æ‰¾åˆ°sourceå±æ€§å°±å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ‰€æœ‰å­—æ®µåŒ…æ‹¬å€¼\næ ¹æœ¬åŸå› åˆ°è¿™é‡Œï¼Œé—®é¢˜ä¼¼ä¹ä¸€ç›®äº†ç„¶äº†ï¼Œæ˜¾ç„¶æ˜¯SpringBootåœ¨è¯»å–é…ç½®æ–‡ä»¶æ—¶ï¼Œæ ¹æ®å­—æ®µæˆ–è€…å€¼åœ¨è½¬æˆjavaå¯¹åº”çš„ç±»å‹æ—¶è½¬å‡ºäº†é—®é¢˜ã€‚é‚£ä¹ˆSpringBootæ˜¯æ€ä¹ˆè¯»å–é…ç½®æ–‡ä»¶çš„å‘¢ï¼Œåº¦å¨˜äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†è¿™ä¸ªç±»YamlPropertySourceLoaderæ˜¯ç”¨äºè¯»å–yamlæ–‡ä»¶çš„ï¼Œï¼ˆé¡ºå¸¦æä¸€å¥ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°ymlå’Œyamlæ˜¯ä¸€ä¸ªæ–‡ä»¶ç±»å‹ï¼‰ã€‚éšååœ¨æ ¸å¿ƒæ–¹æ³•é‡Œå¯ä»¥æ‰¾åˆ°è°ƒç”¨çš„OriginTrackedYamlLoaderè¿™è´§çš„loadæ–¹æ³•\npublic List&lt;PropertySource&lt;?&gt;&gt; load(String name, Resource resource) throws IOException &#123;\n\tif (!ClassUtils.isPresent(&quot;org.yaml.snakeyaml.Yaml&quot;, getClass().getClassLoader())) &#123;\n\t\tthrow new IllegalStateException(\n\t\t\t\t&quot;Attempted to load &quot; + name + &quot; but snakeyaml was not found on the classpath&quot;);\n\t&#125;\n\t&#x2F;&#x2F; å°±åœ¨è¿™é‡Œ\n\tList&lt;Map&lt;String, Object&gt;&gt; loaded &#x3D; new OriginTrackedYamlLoader(resource).load();\n\tif (loaded.isEmpty()) &#123;\n\t\treturn Collections.emptyList();\n\t&#125;\n\tList&lt;PropertySource&lt;?&gt;&gt; propertySources &#x3D; new ArrayList&lt;&gt;(loaded.size());\n\tfor (int i &#x3D; 0; i &lt; loaded.size(); i++) &#123;\n\t\tString documentNumber &#x3D; (loaded.size() !&#x3D; 1) ? &quot; (document #&quot; + i + &quot;)&quot; : &quot;&quot;;\n\t\tpropertySources.add(new OriginTrackedMapPropertySource(name + documentNumber,\n\t\t\t\tCollections.unmodifiableMap(loaded.get(i)), true));\n\t&#125;\n\treturn propertySources;\n&#125;\nåœ¨loadé‡Œé¢ç»§ç»­è°ƒç”¨äº†YamlProcessorç±»çš„processæ–¹æ³•\nprivate boolean process(MatchCallback callback, Yaml yaml, Resource resource) &#123;\n\tint count &#x3D; 0;\n\ttry &#123;\n\t\tif (logger.isDebugEnabled()) &#123;\n\t\t\tlogger.debug(&quot;Loading from YAML: &quot; + resource);\n\t\t&#125;\n\t\ttry (Reader reader &#x3D; new UnicodeReader(resource.getInputStream())) &#123;\n\t\t\t&#x2F;&#x2F; åœ¨è¿™é‡Œæ‰ä¼šåŠ è½½yaml\n\t\t\tfor (Object object : yaml.loadAll(reader)) &#123;\n\t\t\t\tif (object !&#x3D; null &amp;&amp; process(asMap(object), callback)) &#123;\n\t\t\t\t\tcount++;\n\t\t\t\t\tif (this.resolutionMethod &#x3D;&#x3D; ResolutionMethod.FIRST_FOUND) &#123;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t\tif (logger.isDebugEnabled()) &#123;\n\t\t\t\tlogger.debug(&quot;Loaded &quot; + count + &quot; document&quot; + (count &gt; 1 ? &quot;s&quot; : &quot;&quot;) +\n\t\t\t\t\t\t&quot; from YAML resource: &quot; + resource);\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n\tcatch (IOException ex) &#123;\n\t\thandleProcessError(resource, ex);\n\t&#125;\n\treturn (count &gt; 0);\n&#125;\nç‚¹è¿›åŠ è½½æ–¹æ³•loadAllçœ‹ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¿˜å‘ç°é…ç½®æ–‡ä»¶ç”¨æ–‡ä»¶æµè¯»å–ï¼‰ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡constructorï¼Œæš‚æ—¶ä¸å»å…³å¿ƒæ€ä¹ˆæ¥çš„ï¼Œå»é‡å†™çš„è¿­ä»£å™¨é‡Œé¢çš„nextæ–¹æ³•å‘ç°è°ƒç”¨çš„æ˜¯constructorå¯¹è±¡çš„getData()æ–¹æ³•ã€‚åœ¨ç‚¹è¿›å»å°±æ˜¯æœ¬æ–‡å¼€å¤´çš„å†…å®¹äº†ï¼Œè¿™é‡Œå°±ä¸å†å¤è¿°äº†ã€‚\næ€»ç»“åˆ°æ­¤ï¼Œæˆ‘ä»¬æ˜ç™½äº†SpringBootè¯»å–é…ç½®æ–‡ä»¶çš„æœºåˆ¶ï¼Œå¹¶ä¸”äº†è§£äº†é…ç½®æ–‡ä»¶æœ‰ä¸€äº›ç‰¹æ®Šçš„è¯­ä¹‰éœ€è¦æ³¨æ„ã€‚è¿™æ¬¡è§‚å¯ŸSpringBootæºç å‘Šä¸€æ®µè½ï¼Œå…¶å®åœ¨ä¸€å¼€å§‹å°±å¤§æ¦‚çŒœåˆ°äº†æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¸…æ¥šä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œé˜…è¯»å®Œæºç æƒ³æ˜ç™½äº†å¾ˆå¤šï¼Œæ„Ÿè§‰åˆæœ‰æˆé•¿äº†ã€‚\n","slug":"ã€SpringBootã€‘è‡ªå®šä¹‰å¤–éƒ¨é…ç½®æ–‡ä»¶è¯»å–","date":"2022-05-27T07:53:01.000Z","categories_index":"","tags_index":"SpringBoot,Java","author_index":"Xin_Chen"},{"id":"426935cfda214078fe347e2ba79a50b5","title":"ã€Linuxã€‘Linuxå‘½ä»¤ç¬”è®°","content":"Linuxå¸¸ç”¨å‘½ä»¤å¼€å¯æŒ‡å®šç«¯å£firewall-cmd --zone&#x3D;public --add-port&#x3D;8080&#x2F;tcp --permanent\n\nå«ä¹‰ï¼š\nâ€“zone\t#ä½œç”¨åŸŸ\nâ€“add-port&#x3D;8080&#x2F;tcp\t#ç«¯å£&#x2F;é€šè®¯åè®®\nâ€“permanent\t#æ°¸ä¹…ç”Ÿæ•ˆ\næŸ¥çœ‹å“ªäº›ç«¯å£æˆ–è€…æœåŠ¡æ˜¯å¼€æ”¾çš„firewall-cmd --list-ports\nfirewall-cmd --list-services\n\né‡å¯é˜²ç«å¢™firewall-cmd --reload\n\njbossç›¸å…³å‘½ä»¤jboss.master.host\nJBOSS_HOME&#x3D;&#x2F;jboss&#x2F;wildfly-14.0.1.Final\nè¿›å…¥binç›®å½•åæ‰§è¡Œ:\nå¼€å¯æœåŠ¡(&amp;è¡¨ç¤ºåå°å¯åŠ¨)\n.&#x2F;standalone.sh&amp;\n\nå…³é—­æœåŠ¡\n.&#x2F;jboss-cli.sh --connect command&#x3D;:shutdown\n\né€šè¿‡å‘½ä»¤è¡Œéƒ¨ç½²waré¦–å…ˆä½¿ç”¨ ./jboss-cli.sh è¿›å…¥ Consoleç•Œé¢\néƒ¨ç½²ï¼š\ndeploy\n\né”€æ¯ï¼š\nundeploy\n\ndomainæ¨¡å¼ç®¡ç†å‘˜è´¦å·å¯†ç admin&#x2F;admin\nç»„ï¼šadmin\nå‡­è¯ï¼š&lt;secret value=&quot;YWRtaW4=&quot; /&gt;\nç”¨æˆ·è´¦å·å¯†ç cargo&#x2F;cargo\nç»„ï¼šuser\nå‡­è¯ï¼š&lt;secret value=&quot;Y2FyZ28=&quot; /&gt;\nJavaå‘½ä»¤æŒ‡å®š Java ç‰ˆæœ¬ï¼š\nupdate-alternatives --config java\nupdate-alternatives --config javac\n\nDockerç›¸å…³æ³¨ï¼š\nå¦‚æœä¸æ˜¯ä½¿ç”¨ root ç”¨æˆ·ï¼Œæ™®é€šç”¨æˆ·éœ€è¦å…ˆæˆæƒï¼Œ\næˆæƒè¿‡ç¨‹å¦‚ä¸‹ï¼š\nsudo gpasswd -a $&#123;USER&#125; dockerroot  # æ–°ç‰ˆdockerç»„åæ˜¯dockerrootï¼Œè€ç‰ˆæœ¬æ˜¯dockerï¼Œå¦‚ä¸ç¡®å®šï¼Œå¯ä»¥å»&#x2F;etc&#x2F;groupæŸ¥çœ‹\nnewgrp dockerroot\nsudo systemctl restart docker  # é‡å¯docker\nsudo chmod a+rw &#x2F;var&#x2F;run&#x2F;docker.sock  #ç»™ç”¨æˆ·æˆæƒ\n\nè®¿é—®jbossJDK11 dockerfileç¼–å†™ï¼š\n# jdkä¾èµ–äºç³»ç»Ÿ\nFROM centos:7.6.1810\n# åˆ›å»ºäººå’Œé‚®ç®±\nMAINTAINER han &lt;2278461857@qq.com&gt;\n# åˆ›å»ºç›®å½•\nRUN mkdir &#x2F;usr&#x2F;local&#x2F;java\n# æŠŠå‹ç¼©åŒ…ç§»åˆ°ç›®å½•ä¸‹ï¼Œè‡ªåŠ¨è§£å‹\nADD jdk-11.tar.gz &#x2F;usr&#x2F;local&#x2F;java&#x2F;\n# ä¿®æ”¹æ—¶åŒº\nRUN ln -sf &#x2F;usr&#x2F;share&#x2F;zone&#x2F;info&#x2F;Asia&#x2F;Shanghai &#x2F;etc&#x2F;localtime\n# ç¼–è¾‘ç¯å¢ƒå˜é‡\nENV JAVA_HOME &#x2F;usr&#x2F;local&#x2F;java&#x2F;jdk-11.0.13\nENV PATH $JAVA_HOME&#x2F;bin:$PATH\n# VOLUME æŒ‡å®šäº†ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸º&#x2F;tmp\n# å…¶æ•ˆæœæ˜¯åœ¨ä¸»æœº &#x2F;var&#x2F;lib&#x2F;docker ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶é“¾æ¥åˆ°å®¹å™¨çš„&#x2F;tmp\nVOLUME &#x2F;tmp\n\nwildfly dockerfileç¼–å†™ï¼š\n# ä¾èµ–äºjava11\nFROM java:11\n# åˆ›å»ºäººå’Œé‚®ç®±\nMAINTAINER han &lt;2278461857@qq.com&gt;\n# åˆ›å»ºç›®å½•\nRUN mkdir &#x2F;usr&#x2F;local&#x2F;wildfly\n# ç§»åŠ¨ç›®å½•\nCOPY .&#x2F;wildfly-14.0.1.Final &#x2F;usr&#x2F;local&#x2F;wildfly&#x2F;\n# ä¿®æ”¹æ—¶åŒº\nRUN ln -sf &#x2F;usr&#x2F;share&#x2F;zone&#x2F;info&#x2F;Asia&#x2F;Shanghai &#x2F;etc&#x2F;localtime\n# è¿›å…¥å·¥ä½œç›®å½•\nWORKDIR &#x2F;usr&#x2F;local&#x2F;wildfly&#x2F;wildfly-14.0.1.Final&#x2F;bin\n# å¼€æ”¾ç«¯å£\nEXPOSE 9990\nRUN .&#x2F;domain.sh\n\nä¸»æœºåœ°å€172.17.0.2\nk8så®‰è£…å’Œä½¿ç”¨é¦–å…ˆå®‰è£…k8sï¼š\nyum install -y etcd kubernetes\n\nä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š\nvim &#x2F;etc&#x2F;sysconfig&#x2F;docker\n# å°†   --selinux-enabled   æ”¹ä¸º   --selinux-enabled&#x3D;false --insecure-registry gcr.io\nvim &#x2F;etc&#x2F;kubernetes&#x2F;apiserver\n#å°†  KUBE_ADMISSION_CONTROL  å‚æ•°ä¸­çš„  ServiceAccount  åˆ é™¤\n\nå¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼š\nfor s in etcd docker kube-apiserver kube-controller-manager kube-scheduler kubelet kube-proxy; do systemctl start $s; done\n\nkubeadm init â€“apiserver-advertise-address&#x3D;192.168.237.138 â€“image-repository registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers â€“kubernetes-version v1.17.3 â€“service-cidr&#x3D;10.96.0.0&#x2F;16 â€“pod-network-cidr&#x3D;192.168.0.0&#x2F;16\nkubeadm join 192.168.237.138:6443 â€“token ypj4qv.zojv6yetx417hg5c     â€“discovery-token-ca-cert-hash sha256:8610f6f786fb73968577862a0094e65a93a017276d1f6f0da1c1b01778b39fc6 \næ°¸ä¸è¿‡æœŸçš„ä»¤ç‰Œï¼š\nkubeadm join 192.168.237.138:6443 --token è‡ªå·±çš„token     --discovery-token-ca-cert-hash sha256:8610f6f786fb73968577862a0094e65a93a017276d1f6f0da1c1b01778b39fc6\n\n\n\nåˆ›å»ºpodèŠ‚ç‚¹é…ç½®æ–‡ä»¶åˆ›å»ºå‘½ä»¤ï¼škubectl create -f jboss-rc.yaml\napiVersion: v1\nkind: ReplicationController    # å‰¯æœ¬æ§åˆ¶å™¨RC\nmetadata:\n  name: jboss                  # RCçš„åç§°ï¼Œå…¨å±€å”¯ä¸€\nspec:\n  replicas: 1                  # Podå‰¯æœ¬çš„æœŸå¾…æ•°é‡\n  selector:\n    app: jboss                 # ç¬¦åˆç›®æ ‡çš„Podæ‹¥æœ‰æ­¤æ ‡ç­¾\n  template:                    # æ ¹æ®æ­¤æ¨¡æ¿åˆ›å»ºPodçš„å‰¯æœ¬ï¼ˆå®ä¾‹ï¼‰\n    metadata:\n      labels:\n        app: jboss             # Podå‰¯æœ¬æ‹¥æœ‰çš„æ ‡ç­¾ï¼Œå¯¹åº”RCçš„Selector\n    spec:\n      containers:              # Podå†…å®¹å™¨çš„å®šä¹‰éƒ¨åˆ†\n        - name: jboss-master     # å®¹å™¨çš„åç§°\n          image: jboss:master    # å®¹å™¨å¯¹åº”çš„Docker image\n          ports:\n          - containerPort: 8080  # å®¹å™¨åº”ç”¨ç›‘å¬çš„ç«¯å£å·\n          - containerPort: 8230\n        # env:                 # æ³¨å…¥å®¹å™¨å†…çš„ç¯å¢ƒå˜é‡\n        # - name: MYSQL_ROOT_PASSWORD                     \n          # value: &quot;123456&quot;\n\nå›ºå®šipï¼š\nannotations:\n       cni.projectcalico.org&#x2F;ipAddrs: &quot;[\\&quot;10.0.113.137\\&quot;]&quot;\n\n\n\né—®é¢˜è®¿é—®æŒ‚è½½ç‚¹å‡ºç°æƒé™ä¸è¶³ç›®å½•ç»“æ„ååŠ ä¸Š --privileged=true \nä¾‹ï¼š\ndocker run -i -t -v &#x2F;jboss&#x2F;:&#x2F;root&#x2F;jboss --privileged&#x3D;true  jboss:master &#x2F;bin&#x2F;bash\n\ndockerå¯åŠ¨æŠ¥é”™unable to configure the Docker daemon with fileå¯èƒ½æ˜¯ç”±äºdaemon.jsonæ–‡ä»¶é‡Œé…ç½®çš„ç§æœ‰æ–‡ä»¶ä»“åº“å’Œé…ç½®æ–‡ä»¶å†²çª\nå‡ ä¸ªé…ç½®æ–‡ä»¶ï¼š\nEnvironmentFile&#x3D;-&#x2F;run&#x2F;containers&#x2F;registries.conf\nEnvironmentFile&#x3D;-&#x2F;etc&#x2F;sysconfig&#x2F;docker\nEnvironmentFile&#x3D;-&#x2F;etc&#x2F;sysconfig&#x2F;docker-storage\nEnvironmentFile&#x3D;-&#x2F;etc&#x2F;sysconfig&#x2F;docker-network\n\nè¿™æ¬¡æ˜¯åœ¨ -&#x2F;etc&#x2F;sysconfig&#x2F;docker é‡Œæ‰¾åˆ°å†²çª\næ³¨ï¼šä»–æœºè®¿é—®å¯èƒ½å‡ºç°æŠ¥é”™\n# ä¿®æ”¹å¯åŠ¨å‚æ•°ï¼Œä¿¡ä»»ç§æœ‰ä»“åº“\nvim &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;docker.service\n# åŠ ä¸Š--insecure-registry $&#123;192.168.92.134:5000&#125;\n\nk8s nodeèŠ‚ç‚¹ä¼šä¼˜å…ˆè¯»å–æœ¬åœ°çš„é•œåƒï¼Œè€Œä¸æ˜¯å»ä»“åº“æ‹‰å–*kubeadmåˆå§‹åŒ–é—®é¢˜pod-network-cidrå‚æ•°æ‰€æŒ‡å‘çš„ipå­ç½‘ä¸èƒ½å’Œä¸»æœºå­ç½‘ç›¸åŒï¼ï¼ï¼ï¼ï¼ï¼ï¼\nå³å¦‚æœæ‚¨çš„ç½‘ç»œè¿è¡Œåœ¨192.168.*.*ä½¿ç”¨10.0.0.0&#x2F;16\nå¦‚æœæ‚¨çš„ç½‘ç»œæ˜¯10.0.*.*ä½¿ç”¨192.168.0.0&#x2F;16\nå‡ºç°pingä¸é€špodçš„æƒ…å†µä¿®æ”¹calico.yamlæ–‡ä»¶\nä¿®æ”¹calico-nodeçš„envåŠ ä¸Šï¼š\n- name: IP_AUTODETECTION_METHOD\n  value: &quot;interface&#x3D;em1&quot;     # em1 æ˜¯å®é™…ç½‘å¡\n","slug":"Linuxå‘½ä»¤ç¬”è®°","date":"2022-05-27T07:27:22.000Z","categories_index":"","tags_index":"linux","author_index":"Xin_Chen"},{"id":"b9663f58f18133b35bfe243f3e916a80","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2022-05-26T11:33:49.450Z","categories_index":"","tags_index":"","author_index":"Xin_Chen"}]